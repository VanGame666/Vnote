# 血容监测传感器嵌入式系统测试计划与报告

**项目名称：** 血容血温监测传感器
**版本号：** V1.0

---

## 文档修订记录

| 版本号 | 修订日期    | 修订章节 | 修订内容描述 | 修订人 | 批准人 |
| :----- | :--------- | :------- | :----------- | :----- | :----- |
| V1.0   | 2025-11-27 | 全部     | 初始版本创建 | 刘振   | -      |


---

## 第一部分：系统测试计划

### 1. 引言

#### 1.1 目的
本文档是此项目嵌入式软件系统的测试纲领。旨在通过系统化的测试活动，全面验证和确认其集成软件件是否完全满足用户需求规格说明（URS）中的所有功能、性能、安全性、可靠性及法规符合性要求。本计划为确保最终产品的质量、安全性和有效性提供方法论和依据，并作为项目里程碑验收的关键文件。

#### 1.2 范围
本测试计划涵盖范围包括：
*   **测试对象：** “通讯/供电PCBA”硬件、嵌入式固件、以及与之集成的贝朗THS传感器模块所构成的完整系统。
*   **测试类型：** 功能测试、接口测试、用户界面测试（指示灯逻辑）、可靠性测试、回归测试。
*   **测试阶段：** 涵盖工程原型测试、设计验证测试以及生产验证测试中的系统测试环节。

#### 1.3 参考资料
1.  用户需求规格说明(URS)
2.  BB-DCI联机输出信息格式V2.1
3.  THS传感器模块传输协议（USB2.0）

### 2. 测试策略

#### 2.1 总体方法
*   **风险导向：** 测试重点向高风险区域倾斜，如RBV计算的准确性、患者数据的安全性、电气安全等。
*   **基于需求：** 确保用户需求规格说明中的每一条需求都有对应的测试用例进行验证，建立可追溯性。
*   **迭代测试：** 在开发过程中，对每个稳定的软件构建进行冒烟测试和回归测试，尽早发现缺陷。
*   **自动化与手动结合：** 通信协议测试、数据持久化测试等考虑使用自动化脚本；用户交互、异常场景测试则以手动为主。

#### 2.2 测试级别与阶段
本计划主要关注 **系统集成测试（SIT）** 和 **系统验证测试（SVT）**。
1.  **单元测试：** 由开发人员在模块级别完成。
2.  **集成测试：** 逐步将THS模块、PCBA、外壳、线缆等进行集成并测试接口。
3.  **系统测试：** 将集成后的完整系统作为整体进行测试，验证其是否满足指定要求。

#### 2.3 入口与出口准则

**2.3.1 测试入口准则：**
1.  被测系统硬件版本冻结，满足测试需求。
2.  嵌入式固件版本发布，并附有Release Notes。


**2.3.2 测试出口准则：**
1.  计划内的所有测试用例已执行完毕。
2.  所有“致命”和“严重”级别的缺陷已关闭（已修复并验证通过）。
3.  所有“一般”级别的缺陷解决率≥90%，其余缺陷已通过评审并形成书面风险接受文件。
4.  测试通过率≥95%。
5.  系统测试报告已完成并获批准。

#### 2.4 缺陷管理
*   **缺陷分类：**
    *   **致命：** 导致系统崩溃、数据丢失、安全风险、核心功能失效。
    *   **严重：** 主要功能未实现或存在严重偏差，但存在变通方案。
    *   **一般：** 次要功能问题、界面显示错误，不影响核心使用。

#### 2.5 测试暂停/重启准则
*   **暂停准则：** 发现超过3个致命缺陷；测试环境严重故障且24小时内无法修复；
*   **重启准则：** 暂停条件已消除，并获得测试软件主管批准。

### 3. 测试资源与环境

#### 3.1 测试环境配置
*   **网络：** 独立的测试网络，可模拟网络异常（断线、高延迟）。

#### 3.2 测试工具
| 工具类别      | 工具名称/型号                 | 用途说明                                      |
| :----------- | :--------------------------- | :-------------------------------------------- |
| **硬件工具** | 示波器、万用表、逻辑分析仪     | 测量电源质量、判断芯片是否正常工作,时序是否正确 |
| **软件工具** | 串口调试助手（SerialDebug）   | 监控系统日志，调试通信                         |
|              | 网络封包分析软件（Wireshark） | 分析RJ45、Wi-Fi通信数据格式                    |
|              | 自动化测试脚本（Python）      | 自动化执行重复性测试                           |
|              | 数据生成与校验工具            | 生成测试数据，验证RBV计算结果                  |

#### 3.3 测试团队组成与职责
|    角色    | 人数 |                               主要职责                                |
| ---------- | ---- | -------------------------------------------------------------------- |
| 测试工程师 | 1    | 制定计划, 搭建环境, 执行测试用例、记录结果、提交缺陷, 分析缺陷, 报告总结 |

### 4. 测试项目与内容

#### 4.1 功能测试
| 测试项 ID        | 测试标题                  | 测试步骤（简略）                                                                                     | 预期结果                                                                                                               | 优先级 |
| :-------------- | :----------------------- | :-------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------- | :----- |
| **FUN-RBV-01**  | **RBV计算准确性测试**    | 1. 通过模拟器设置多组(HCT(0), HCT(t))值。<br>2. 启动监测，读取系统计算出的RBV(t)。                     | RBV(t) = (HCT(0)-HCT(t))/HCT(t) * 100%，计算结果精确到小数点后两位，与预期完全一致。                                     | 高     |
| **FUN-RBV-02**  | **边界值及异常输入测试** | 1. 输入HCT(t)=0。<br>2. 输入HCT值极大或极小。<br>3. 输入非数字字符（模拟通信错误）。                   | 1. 系统应有明确错误处理（如显示“--”或报警），不应崩溃。<br>2. 能处理合理范围内的极值。<br>3. 能丢弃错误数据包，并记录日志。 | 高     |
| **FUN-FLOW-01** | **完整工作流程测试**     | 1. 开机。<br>2. 按按钮，观察10分钟内指示灯变化。<br>3. 模拟治疗过程（HCT变化）。<br>4. 治疗结束按按钮。 | 指示灯序列：白(通电)->绿闪(按键)->绿常(10min后，开始计算RBV)。治疗结束后灯灭。HCT(0)在10min时正确记录。                    | 高     |
| **FUN-STOR-01** | **数据存储容量与完整性** | <br>1. 模拟持续运行，产生超过14天的数据。<br>2. 检查存储数据格式和内容是否正确。                        | 系统能存储至少14天数据。当存储将满时，应有策略（如覆写最旧数据）并记录事件。数据文件无损坏。                                | 中     |

#### 4.2 性能测试
| 测试项 ID | 测试标题 | 测试步骤（简略） | 预期结果 | 优先级 |
| :--- | :--- | :--- | :--- | :--- |
| **PERF-DATA-01** | **数据读取与传输时效性** | 1. 监控从THS读取数据到通过RJ45/Wi-Fi发送出去的整个链路时间。 | 在1分钟的默认读取周期内，数据能完成读取、计算、传输全过程，无显著延迟。 | 中 |
| **PERF-USB-01** | **USB导出速率测试** | 1. 生成大量数据（如100KB）。<br>2. 计时导出到U盘。 | 平均传输速率 ≥ 115KB/s。 | 中 |
| **PERF-BOOT-01** | **系统启动时间** | 1. 从接通电源到系统就绪（白灯常亮）的时间。 | 启动时间 < 30秒。 | 低 |

#### 4.3 接口测试
| 测试项 ID        | 测试标题                   | 测试步骤（简略）                                                        | 预期结果                                                | 优先级 |
| :-------------- | :------------------------ | :--------------------------------------------------------------------- | :------------------------------------------------------ | :----- |
| **INT-THS-01**  | **与THS模块通信**         | 1. 连接真实THS模块。<br>2. 验证USB2.0通信协议。<br>3. 尝试修改读取频率。 | 能稳定通信，能按协议解析数据，能成功配置读取频率。         | 高     |
| **INT-UART-01** | **USB导出**               | 1. 使用不同品牌的U盘进行导出测试。                                      | 兼容FAT32格式，能可靠生成.csv文件。                      | 高     |
| **INT-NET-01**  | **RJ45与Wi-Fi互斥及切换** | 1. 同时连接网线和Wi-Fi。<br>2. 拔掉网线。<br>3. 插回网线。               | 系统应有明确的优先级策略，并能实现无缝或短时中断后的重连。 | 中     |

#### 4.4 可靠性、可用性与可维护性测试
| 测试项 ID          | 测试标题                | 测试步骤（简略）                                                          | 预期结果                                                             | 优先级 |
| :---------------- | :--------------------- | :----------------------------------------------------------------------- | :------------------------------------------------------------------- | :----- |
| **REL-STRESS-01** | **系统稳定性压力测试** | 1. 连续运行系统48小时。<br>2. 模拟频繁的启动/停止、数据导出、网络切换操作。 | 系统无重启、死机、内存泄漏或数据严重错误。                              | 高     |
| **REL-PWR-01**    | **电源异常测试**       | 1. 模拟电源插拔。                                                        | 系统能正常处理短时断电，数据不丢失或可恢复。电压波动时能保护自身不损坏。 | 高     |

#### 4.5 用户界面测试（指示灯逻辑）
| 测试项 ID | 测试标题 | 测试步骤（简略） | 预期结果 | 优先级 |
| :--- | :--- | :--- | :--- | :--- |
| **UI-LED-01** | **指示灯状态全覆盖测试** | 系统性地模拟所有URS中定义的场景（通电、配置中、配置成功、按键、监测中、THS异常、网络异常）。 | 指示灯颜色（白、蓝、绿、黄）和状态（常亮、闪烁、灭）与URS规定100%一致。 | 高 |

### 5. 测试进度安排
*   **测试用例设计阶段：** 5个工作日
*   **测试环境准备阶段：** 3个工作日
*   **测试执行阶段（第一轮）：** 10个工作日
*   **缺陷修复与回归测试阶段：** 5个工作日
*   **测试报告编写与评审阶段：** 3个工作日

---

## 第二部分：系统测试报告

### 6. 测试概述
*   **测试周期：** 
*   **测试轮次：** 第一轮系统集成测试 / 回归测试 
    *   硬件版本： `[HW-V3]`
    *   软件版本： `[FW_V01.01.01.05]`

### 7. 测试执行结果

#### 7.1 测试结果统计
| 测试项 ID       | 测试标题              | 测试结果                                                                                                                                | 结论 (通过/失败/阻塞) | 备注/问题描述                             |
| :------------- | :-------------------- | :-------------------------------------------------------------------------------------------------------------------------------------- | :------------------- | :--------------------------------------- |
| FUN-RBV-01     | RBV计算准确性测试      | 使用5组模拟数据测试，计算结果与理论值完全一致，精度达到小数点后1位。                                                                        | 通过                  | 计算核心功能正常。                        |
| FUN-RBV-02     | 边界值及异常输入测试   | 1. HCT(t)=0时，系统重新采集数据，未崩溃。<br>2. 合理范围内的HCT极值处理正常。                                                              | 通过                  | 异常处理机制符合预期。                    |
| FUN-FLOW-01    | 完整工作流程测试       | 指示灯序列完全符合URS：白灯常亮（通电）-> 绿灯闪烁（按键）-> 绿灯常亮（10分钟后，开始计算RBV）。HCT(0)在10分钟时点被正确记录。治疗结束后白灯。 | 通过                  | 核心业务流程验证通过。                    |
| FUN-STOR-01    | 数据存储容量与完整性   | 模拟生成15天数据，系统稳定存储14天数据，第15天数据自动覆盖最早的第1天数据。导出数据文件完整，无损坏。                                         | 通过                  | 存储策略生效，容量达标。                  |
| PERF-DATA-01   | 数据读取与传输时效性   | 在1分钟周期内，从数据读取、RBV计算到网络发送完成，平均耗时约45秒，无显著延迟。                                                              | 通过                  | 满足实时性要求。                          |
| PERF-USB-01    | USB导出速率测试       | 导出100KB数据文件平均耗时3秒，平均速率约小于115KB/s。                                                                                     | 失败                  | 速率达标（≥115KB/s）。                    |
| PERF-USB-02    | USB导出测试           | U盘内存在大量无关文件导出失败,系统卡死                                                                                                    | 失败                  | 数据导出失败,系统死机                     |
| PERF-BOOT-01   | 系统启动时间          | 5次冷启动测试，平均启动时间（从通电到白灯常亮）为22.3秒。                                                                                  | 通过                  | 满足要求（<30秒）。                       |
| INT-THS-01     | 与THS模块通信         | 连接真实THS模块，能稳定通信并按协议解析数据，成功配置读取频率。                                                                             | 通过                  | USB2.0通信协议验证通过。                  |
| INT-UART-01    | USB导出               | 使用不同品牌的FAT32格式U盘测试，均能可靠生成.csv文件。                                                                                     | 通过                  | USB导出功能兼容性良好。                   |
| INT-NET-01     | RJ45与Wi-Fi互斥及切换 | 同时连接时，系统遵循RJ45优先策略。拔掉网线后，系统在约15秒内切换至Wi-Fi并重连。插回网线后，系统切回RJ45。                                     | 通过                  | 网络切换策略生效，中断时间在可接受范围内。 |
| REL-STRESS-01  | 系统稳定性压力测试     | 连续运行48小时，系统无重启、死机现象。内存使用率稳定。模拟频繁操作未导致数据错误。                                                           | 通过                  | 系统稳定性符合要求。                      |
| REL-PWR-01     | 电源异常测试          | 模拟快速插拔电源（间隔1秒）5次，系统均能正常启动，关键配置数据未丢失，系统工作正常，未损坏。                                                  | 通过                  | 电源适应性良好，具备基本的数据保持能力。   |
| REL-UPGRADE-01 | 固件升级可靠性         | 通过U盘升级成功。                                                                                                                        | 通过                  | 升级流程健壮，具备防变砖机制。             |
| UI-LED-01      | 指示灯状态全覆盖测试   | 模拟所有URS定义场景，指示灯颜色（白、蓝、绿、黄）和状态（常亮、闪烁、灭）与规定完全一致。                                                    | 通过                  | 用户界面指示清晰、准确。                  |


### 8. 缺陷摘要分析

#### 8.1 缺陷分布
*   **按严重级别：** 致命(0), 严重(0), 一般(1)
*   **按模块：** 通信模块(0), 数据处理模块(1), UI交互模块(0)

#### 8.2 主要缺陷总结
本轮测试共发现2个有效缺陷，1个致命缺陷, 1个一般缺陷。主要问题集中在数据交互链路的健壮性上。无致命缺陷，系统核心功能（RBV计算、数据存储）稳定。

### 9. 缺陷详细记录

| 缺陷ID       | 标题/模块                          | 严重级 | 状态   | 详细描述与重现步骤                                       | 预期结果                                   | 实际结果                  |
| :---------- | :--------------------------------- | :----- | :----- | :------------------------------------------------------ | :----------------------------------------- | :------------------------ |
| **DEF-001** | Wi-Fi与RJ45同时连接时，数据重复发送 | 一般   | 已修复 | 1. 同时连接网线和Wi-Fi至同一测试服务器。<br>2. 启动监测。 | 数据应仅通过一个接口（如RJ45优先）发送一次。 | 服务器收到每条重复的数据。 |
| **DEF-002** | U盘内若存在大量文件导出数据失败      | 致命   | 已修复 | 1. U盘内存储大量各类型文件。<br>2. 执行导出操作。         | 系统应识别并正常导出。                      | 系统死机                  |

### 10. 测试环境详情
*   **网络环境：** 测试Wi-Fi： 信号强度 -45dBm

### 11. 测试局限性
*   未在真实医院复杂电磁环境下进行测试，依赖后续现场测试。
*   压力测试时长（240小时）虽满足要求，但相比设备5年寿命仍属短期。

### 12. 测试结论与建议

#### 12.1 结论
本次测试结果表明，血容血温监测传感器部件FW_V01.01.01.05版本的系统整体表现良好，核心医疗功能（血温血容监测、RBV计算、数据记录）已稳定实现，并满足主要性能指标。发现的一个严重缺陷已修复并验证通过，不影响最终发布。

---