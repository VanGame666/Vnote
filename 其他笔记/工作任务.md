# WorkTask

---

<mark>1. 贝朗需求</mark>
![](vx_images/269096154278196.png)
<mark>2. 贝朗加密</mark>
<mark>3. ESP32需求</mark>
<mark>4. ~~ESP32移植~~</mark>





---
1. Is the eheamet onnetion secured against alacks via the netwonk? fyes, how? Especialy. DosdDos, Manpuaion ofthe device soware,ainpuaion or read out ofstored dala (Neasurement valuesWifipasswor.,.Explanaion: one of our biggestweakneses would be ifthe device solware ould be mampulated via netwok and used as part of a Bonet arsimar, atacking otherdevices in thenetwork or just flooding everything with a dDos.
- <mark> 由于设备只实现了数据的发送,并不实现接收数据,所以网络数据并不会到达软件协议层,影响CPU的正常运行</mark>
- <mark>如果遭遇了DOS攻击, 接收的恶意数据, 在硬件层面会由DMA自动进行搬运到缓冲区覆盖之前的恶意数据, 从网络数据的入口根本上杜绝了恶意数据对软件层面的干扰, 不会上传软件应用层, 构成了硬件第一道防线</mark>
- <mark>软件层面,由于精简了许多不必要的网络协议,使设备专注于TCP客户端,其余数据直接丢弃,所以哪怕恶意数据上传到应用层,也不会进行处理</mark>
- <mark> 如果需要更完善和极端的网络防御措施, 由于资源和性能限制, 只凭设备本身是无法构建完善的网络防御, 需要从服务器方面防御恶意访问的入侵</mark>
---

2. I supose there is any time synchronzation since the THS needsa ime shamp.How is this realzed? Howis itensured that he imeis orect(corect time zone,summerwintertime, notmanipulated dalasource)?
- <mark>目前设备指示连接医院的局域网,并不是连接外部的互联网络,所以无法从互联网上获得时间,任然需要工作人员手动通过U盘配置文件设置时间,或则可以同步医院服务器的时间,但这需要医院服务器具有NTP网络时间服务功能</mark>
---
3. The lP adrres in the conforaton fle-is ithe adres ofthe THS orthe addres of he sener? in boh cases: how is the cher P addres set? There might be cinics wih or without DHCP
- <mark>配置的是设备需要连接的服务器地址, 设备由于交互接口较少, 所有配置都是通过U盘实现的, 服务器的地址是由医院提供的, 现在基本没有不支持DHCP功能的网络, 除非是医院刻意人为的禁止DHCP功能, 但是如果禁止DHCP功能, 设备的维护安装将会非常麻烦, 因为你无法知道人工设置的IP地址是否已存在被其他设备使用,造成IP地址冲突,设备无法正常传输数据, 但是如果需要,可以后续添加是否启用DHCP动态IP,或则使用人工设置静态IP</mark>
---
4. Does THS save measuremen data as some kind ofbute,andwmenthe user plugs in a UsB sic. tis coped there oris there ony a"lwve sawngincase anUsE stckis connedted dumng measurement.
In case it is buffered, how and how long?
- <mark> 设备可存储20K条调数据,文件大小大概2M,按照一次治疗时间4小时,每分钟记录2次计算,每次治疗需记录大概500条,每天治疗两次,一天1K条治疗数据,能够至少存储20天的数据</mark>
- <mark>数据是存储到内部文件系统的,检测到U盘插入并且存在导出文件时才会执行数据导出功能</mark>
- <mark>内部存在缓冲机制, 不过这是为了避免每次仅写入少量数据而却擦除4K大小空间,造成Flash存储设备使用擦除寿命消耗浪费的策略,再此基础上,每记录4K大小数据,大概40条数据,每20分钟便会写入一次内部文件系统,然后治疗结束,等待外部U盘插入,拷贝数据</mark>
---
5. I conclude that there is any kind of sw update funcionalty planed. That makes me a lot of headaches oncering secunl,silnce it would have to be secured properly (usualy requireing a PKiinfrastructure, certificate handling, etc),. How is it technically realized?
- <mark>设备会在每个芯片出厂前使用TEA和MD5算法进行加密处理,利用芯片的唯一ID生成哈希值,并存储在flash设备只可编程一次的区域,后续无法更改,每次程序运行前都会重新计算哈希值,并与出厂前计算的哈希值对比, 只有厂家发布的包含密钥验证软件才可正常升级运行</mark>
---
6. What happens if a keyboard is comneced to the UsB port? ls it posible to interere with FreeRos in any way?Amy mamipulaions posible? f no, how is itensured? f yes, prohibitit
- <mark>如键盘之类的其他设备不会产生任何影响,因为根据USB协议,所有USB接口设备都要遵循USB协议,外部USB接口插入设备时,双方设备都要进行身份验证, 储类型(如U盘),还是HID人机交互类型(如键盘,鼠标),或则视频类(如USB摄像头),如果身份验证并不是U盘,或则并没有遵循USB协议,不会进行任何设备内部操作</mark>
 
